<section class="event-details">
  @if (loading) {
    <div class="loading">
      <mat-spinner diameter="40"></mat-spinner>
      <span>Loading event…</span>
    </div>
  }
  @else if (error) {
    <div class="error">{{ error }}</div>
    <a mat-button color="primary" routerLink="/attendee/published-events">Back to events</a>
  }
  @else if (event) {
    <mat-card appearance="outlined">
      <div class="event-header-image" [style.background-image]="'url(' + getEventImage(event.type) + ')'"></div>
      <mat-card-header>
        <mat-card-title>{{ event.name }}</mat-card-title>
        <mat-card-subtitle>{{ event.type || 'Event' }} • {{ event.venue }}</mat-card-subtitle>
      </mat-card-header>
      <mat-card-content>
        @if (event.description) {
          <div class="description">
            <p>{{ event.description }}</p>
          </div>
        }
        <div class="time">
          <span class="label">Starts:</span>
          <span>{{ event.start | date: 'full' }}</span>
        </div>
        <div class="time">
          <span class="label">Ends:</span>
          <span>{{ event.end | date: 'full' }}</span>
        </div>

        @if (event.ticketTypes.length) {
          <div class="tickets">
            <h3>Available Tickets</h3>
            <div class="ticket-cards">
              @for (t of event.ticketTypes; track t.id) {
                <mat-card appearance="outlined" class="ticket-card">
                  <mat-card-header>
                    <mat-card-title>{{ t.name }}</mat-card-title>
                    <mat-card-subtitle>{{ t.price | currency }}</mat-card-subtitle>
                  </mat-card-header>
                  <mat-card-content>
                    <p>{{ t.description }}</p>
                  </mat-card-content>
                  <mat-card-actions align="end">
                    <button mat-raised-button color="primary" (click)="purchaseTicket(event.id, t.id)">
                      Purchase Ticket
                    </button>
                  </mat-card-actions>
                </mat-card>
              }
            </div>
          </div>
        }
      </mat-card-content>
      <mat-card-actions align="end">
        <a mat-flat-button color="primary" routerLink="/attendee/published-events">Back</a>
      </mat-card-actions>
    </mat-card>
  }
</section>
